{% extends "base.html" %}

{% block title %}INT Active Trials{% endblock %}

{% block content %}
<div class="header">
  <h1 class="header-title">INT Active Clinical Trials</h1>
  <p class="header-subtitle">Active clinical trials at Istituto Nazionale dei Tumori</p>
</div>

<div class="card mb-4">
  <div class="card-header">
    <h5 class="card-header-title">Filter Trials</h5>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-4">
        <div class="form-group">
          <label for="search-input" class="form-label">Search</label>
          <input type="text" id="search-input" class="form-control" placeholder="Search by keyword or protocol ID (e.g., D5087C00001)...">
          <div class="form-select-label text-muted">Search by NCT ID</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-group">
          <label for="phase-filter" class="form-label">Phase</label>
          <select id="phase-filter" class="form-control">
            <option value="">All Phases</option>
            <option value="Phase I">Phase I</option>
            <option value="Phase I/II">Phase I/II</option>
            <option value="Phase II">Phase II</option>
            <option value="Phase III">Phase III</option>
          </select>
          <div class="form-select-label text-muted">Select the phase of the trial</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-group">
          <label for="cancer-type-filter" class="form-label">Cancer Type</label>
          <select id="cancer-type-filter" class="form-control">
            <option value="">All Types</option>
            <option value="lung">Lung Cancer</option>
            <option value="breast">Breast Cancer</option>
            <option value="colorectal">Colorectal Cancer</option>
            <option value="ovarian">Ovarian Cancer</option>
            <option value="solid">Solid Tumors</option>
          </select>
          <div class="form-select-label text-muted">Filter by cancer type</div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="trials-container">
  <!-- Trials will be dynamically inserted here -->
</div>

<!-- Template for JS -->
<template id="trial-card-template">
  <div class="match-card trial-card mb-4">
    <div class="match-card-header">
      <div>
        <h5 class="match-title trial-title"></h5>
        <div class="d-flex align-items-center mt-1">
          <span class="match-phase mr-3"></span>
          <span class="trial-id text-muted"></span>
        </div>
      </div>
      <span class="match-percentage"></span>
    </div>
    <div class="match-card-body">
      <p class="match-description trial-description"></p>
      <div class="match-criteria-container">
        <div class="match-criteria-section">
          <h6 class="match-criteria-title">Inclusion Criteria</h6>
          <div class="inclusion-criteria-container"></div>
        </div>
        <div class="match-criteria-section">
          <h6 class="match-criteria-title">Exclusion Criteria</h6>
          <div class="exclusion-criteria-container"></div>
        </div>
      </div>
    </div>
  </div>
</template>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/trials.js') }}"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    feather.replace();
    const toggle = document.getElementById('mobile-menu-toggle');
    const sidebar = document.querySelector('.sidebar');
    if (toggle && sidebar) {
      toggle.addEventListener('click', () => sidebar.classList.toggle('show'));
    }
  });
</script>
{% endblock %}
